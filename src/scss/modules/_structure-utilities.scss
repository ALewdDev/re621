/* Vanilla Overrides */
// Compatibility fix for modals
body {
    display: flex;
    min-height: 100vh;
    flex-direction: column;

    input:focus,
    textarea:focus,
    select:focus {
        outline: 0;
    }

    div#page {
        flex: 1;
        position: relative;
    }
}

// Fix for notice layering
div#notice {
    z-index: 10000;
}

// Gridify the header
header#top {
    h1 {
        display: none !important;
    }

    nav#nav.grid {
        display: grid !important;
        grid-template-columns: auto 1fr auto;

        menu.logo:not(.main) {
            background: unset;
            margin: 0 0 0 0.5rem;
            padding: 0.25rem 0;
            font-weight: 700;
        }

        menu.logo a {
            padding: 6px 10px;
        }

        menu.main {
            overflow: hidden;
            white-space: nowrap;
            padding-left: 0;
            padding-right: 0;
        }

        menu.extra:not(.main) {
            background: unset;
            margin: 0 0.5rem 0 0;
            padding: 0.25rem 0;
            font-weight: 700;
        }

        menu.extra a {
            padding: 6px 10px;
        }

        menu.submenu {
            grid-row: 2;
            grid-column: 1;
            grid-area: 2 / 1 / 2 / 4;
            height: 1.125rem;
        }
    }
}

// Stickify the header
body[data-sticky-header=true] {
    header#top {
        position: sticky;
        z-index: 9000;
        top: -1px;
    }

    div#re621-search {

        // This is necessary to make the transition smooth
        margin-top: -3.5rem !important;
        padding-top: 3.5rem !important;

        &.re621-search-sticky {
            padding-top: 3.5rem !important;
        }
    }
}

/* Gridify the sidebar */
div#c-posts div#a-index,
div#c-posts div#a-show,
div#c-favorites div#a-index {
    display: grid;
    grid-template-columns: 15em auto;
    grid-column-gap: 1.25rem;

    aside#sidebar {
        width: unset;
        float: unset;

        div#re621-search {
            position: relative;
            margin: -0.5rem -0.5rem 0;
            padding: 0.5rem 0.5rem;
            border-radius: 6px 6px 0 0;

            &[data-sticky=true] {
                position: sticky;
                top: -1px;
                z-index: 50;
            }
        }

        section {
            margin-bottom: 0.5rem;
        }

        section#search-box form,
        section#re-instantsearch form,
        section#mode-box form {
            display: grid;
            grid-template-columns: auto 2rem;

            input[type=text],
            button[type=submit] {
                width: 100%;
            }

            select[name=mode] {
                width: unset;
                grid-column: span 2;
            }
        }
    }

    section#content {
        margin-left: unset;
        padding-left: unset;
    }
}


/* Taglist Helpers */
#tag-box,
#tag-list {

    &>ul {

        // margin-right: -1rem;

        li {
            display: flex;
            line-height: 1rem;
            margin-bottom: 1px;

            position: relative;

            a.search-inc-tag,
            a.search-exl-tag {
                padding-right: 0.125rem;
            }

            span.tag-wrap {
                margin-right: 0.25rem;
            }

            div.tag-actions {
                min-width: fit-content;
                margin-left: auto;
                line-height: 1rem;

                position: absolute;
                right: -1rem;

                span {
                    margin: 0 0.125rem;
                    min-width: fit-content;

                    &.tag-action-blacklist {
                        display: none;
                    }

                    &.tag-action-subscribe a.subscribe {
                        visibility: hidden;
                    }
                }
            }

            span.post-count {
                margin-left: 0.5rem;
                white-space: nowrap;
                font-size: 90%;
            }

            &:hover {

                a.search-tag {
                    white-space: normal;
                    max-width: unset;
                }

                div.tag-actions {

                    span {

                        &.tag-action-blacklist {
                            display: inline-block;
                        }

                        &.tag-action-subscribe a.subscribe {
                            visibility: visible;
                        }
                    }
                }
            }

        }

    }

    &[data-shorten-tagnames=true]>ul {

        li {
            span.tag-wrap {
                display: inline-grid;
            }

            &:hover {
                span.tag-wrap {
                    margin-right: 1rem;
                }

                span.post-count {
                    display: none;
                }
            }
        }

        li:not(:hover) {

            span.tag-wrap {
                display: inline-grid;
                grid-template-columns: auto max-content;
                align-items: center;

                a.search-tag {
                    white-space: nowrap;
                    text-overflow: ellipsis;
                    overflow: hidden;
                }
            }
        }
    }
}

/* Quick-add Tags Override */
div#c-posts div#quick-edit-div textarea {
    width: 100%;
}

/* Error Handling Styles */
textarea.error-feedback {
    width: 100%;
    min-height: 25vh;
    overflow-x: hidden;
    white-space: pre;

    @include scrollbars;
}

/* Increase the size of blacklist form */
textarea#user_blacklisted_tags {
    height: 400px;
}

div.blacklist-character-counter-box {
    width: 80%;
    text-align: right;
    margin-top: -1rem;
    font-size: 0.75rem;
    opacity: 0.5;
}
